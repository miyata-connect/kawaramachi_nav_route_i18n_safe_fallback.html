# Walk-Voice QA Scenarios (v1)
テスト仕様書 — 音声案内・運用ルールのQAシナリオ一覧  
対象：Shortest / Safest / Accessible 各モード

---

## 1. 共通動作テスト

| No | 項目 | 条件 | 期待結果 |
|----|------|------|-----------|
| 1 | 起動時設定 | 言語: 日本語 / モード選択 | 各文言が日本語で表示され、天候選択確認が表示される |
| 2 | 天候回避ダイアログ | 雨雲トリガ発生時 | 「天候回避ルートに切り替えます。よろしいですか？」が表示される |
| 3 | 天候ボタン操作 | ボタン押下時 | 「天候回避ボタンを選択されました…」が音声出力され、案内が切り替わる |
| 4 | 自動リルート防止 | 天候・事故検知 | 自動切替せず、必ず確認ダイアログが出る |
| 5 | 夜間照度優先 | 照度しきい値未満 | Shortest: 回避 / Safest: 高照度経路選択 / Accessible: 高照度＋勾配制約 |

---

## 2. Shortest（最短）モードテスト

| No | 項目 | 条件 | 期待結果 |
|----|------|------|-----------|
| S1 | 路肩許可 | 歩道が無い区間のみ | 経路に含まれるが安全帯の外は除外 |
| S2 | 暗所除外 | 夜間・照度不足 | 該当経路を除外 |
| S3 | 雨天トリガ | 降雨検出 | ダイアログ→承認→「天候回避ルートで案内します」音声 |
| S4 | 高速道路誤検出 | 自専道 | 経路生成エラー／再検索促し |

---

## 3. Safest（安全）モードテスト

| No | 項目 | 条件 | 期待結果 |
|----|------|------|-----------|
| F1 | 勾配判定 | 坂 ≥ 8%（30m 以上） | 経路除外または代替ルート選択 |
| F2 | 階段判定 | 段差検出 | 回避経路に切り替え |
| F3 | 夜間優先 | 照度比較 | 明るい経路を優先 |
| F4 | 雷検知 | 雷警報発令 | 高架・橋梁を避けた経路へ |
| F5 | 再計算確認 | 変更後承認 | 音声「天候回避ルートでご案内します」発話後に更新 |

---

## 4. Accessible（バリアフリー）モードテスト

| No | 項目 | 条件 | 期待結果 |
|----|------|------|-----------|
| A1 | 勾配制約 | 坂 > 5%（30m 以上） | 経路除外 |
| A2 | 階段検出 | 階段・段差あり | 経路除外 |
| A3 | エレベータなし交差 | 立体交差に昇降設備なし | 経路除外 |
| A4 | 天候回避 | 雨天または28°C以上 | 回避経路を提示、音声確認あり |

---

## 5. 季節・天候連動シナリオ

| No | シナリオ | 想定条件 | 結果 |
|----|-----------|-----------|-------|
| W1 | 夏季・28°C超過 | 晴天、直射区間あり | 建物沿い／日陰を優先 |
| W2 | 雷注意報 | 高架・橋上経路含む | 高架経路を除外 |
| W3 | 強風 | 海沿い・橋上含む | 建物沿いを優先 |
| W4 | 降雪 | 勾配あり経路 | 勾配制約強化＋安全帯限定ルート |
| W5 | 周辺事故情報 | 半径5km以内 | 通知表示、ダイアログ確認後に切替 |

---

## 6. 音声出力テスト

| No | イベント | 期待音声 |
|----|-----------|-----------|
| V1 | 雨雲検知 | 「雨雲の接近が確認できました。天候回避ルートに切り替えます。よろしいですか？」 |
| V2 | ユーザー承認後 | 「只今より、天候回避ルートでご案内します。」 |
| V3 | ボタン操作 | 「天候回避ボタンを選択されました…」 |
| V4 | 階段検知 | 「階段を検出しました。Accessibleモードでは回避します。」 |
| V5 | ルート確定 | 「Shortestエーアイで案内を開始します。」 |

---

## 7. 検証ログ出力（Debug 確認）

- `weatherTrigger`: 発火時のログ出力確認  
- `illuminationLevel`: 暗所判定閾値出力  
- `gradientCheck`: 坂勾配データ出力  
- `speechOutput`: 発話トリガーイベント記録  
- `rerouteConfirm`: ダイアログ開閉イベントログ

---

**最終更新**：v1.0（2025-10-20）  
**メンテナー**：miyata-connect / QAチーム
