<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover" />
<title>Walk-NAV</title>

<!-- ã™ã¹ã¦ã®CSSã‚’å†…è”µï¼ˆå¤–éƒ¨CSSä¸è¦ï¼‰ -->
<style>
:root{
  --bg:#0b0f19; --fg:#e7e7ea; --glass:rgba(44,47,58,.55); --blur:12px;
  --brand:#60a5fa; --green:#16a34a; --red:#ef4444; --blue:#3b82f6;
  --panel-w:min(720px,92vw); --radius:18px; --shadow:0 10px 26px rgba(0,0,0,.22);
  --z-panel:500; --z-right:520; --z-compass:530;
}
*,*::before,*::after{ box-sizing:border-box; } /* å…¥åŠ›æ ã¯ã¿å‡ºã—é˜²æ­¢ */
html,body,#map{ height:100%; width:100%; margin:0; background:#000; color:var(--fg);
  font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;
}
#map{ position:fixed; inset:0; }

/* ã‚¬ãƒ©ã‚¹æ¿ */
.glass{
  position:fixed; left:50%; transform:translateX(-50%);
  top:calc(env(safe-area-inset-top,0px) + 10px);
  width:var(--panel-w); max-width:var(--panel-w);
  background:var(--glass); backdrop-filter:blur(var(--blur)); -webkit-backdrop-filter:blur(var(--blur));
  border-radius:var(--radius); box-shadow:var(--shadow); padding:16px; z-index:var(--z-panel);
}
.row{ display:flex; gap:12px; align-items:center; justify-content:center; flex-wrap:wrap; margin-top:12px; }
.grid2{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.center{ text-align:center; }

.input{
  width:100%; height:46px; border:1px solid rgba(255,255,255,.12);
  border-radius:12px; background:rgba(0,0,0,.25); color:var(--fg);
  padding:0 12px; text-align:center;
}
.input::placeholder{ color:#cbd5e1; text-align:center; }

.btn{ border:none; height:44px; padding:0 16px; border-radius:999px; color:#fff;
  background:rgba(255,255,255,.18); cursor:pointer; text-align:center;
}
.primary{ background:var(--brand); }
.green{ background:var(--green); }
.red{   background:var(--red); }
.blue{  background:var(--blue); }

/* å³ç¸¦ãƒœã‚¿ãƒ³ï¼ˆåœ°å›³ä¸Šã€æ¿ã¨è¡çªãªã—ï¼‰ */
.right-stack{
  position:fixed;
  right:max(12px, env(safe-area-inset-right,0px)+12px);
  top:calc(env(safe-area-inset-top,0px)+120px);
  display:flex; flex-direction:column; gap:10px; z-index:var(--z-right);
}
.btn-right{ min-width:110px; background:rgba(59,130,246,.95); border:none; color:#fff; border-radius:14px; height:46px; box-shadow:var(--shadow); }

/* ã‚³ãƒ³ãƒ‘ã‚¹ï¼ˆåœ°å›³å·¦ã€å††å†…å›è»¢/é£›ã³å‡ºã—é˜²æ­¢ï¼‰ */
.compass-wrap{
  position:fixed;
  left:max(12px, env(safe-area-inset-left,0px)+12px);
  top:calc(env(safe-area-inset-top,0px)+120px);
  z-index:var(--z-compass);
}
.compass-dial{ width:82px; height:82px; border-radius:50%; background:rgba(255,255,255,.14); box-shadow:var(--shadow); position:relative; overflow:hidden; }
.compass-needle{ position:absolute; left:50%; top:50%; width:2px; height:38px; background:#ff4d4d;
  transform-origin:50% 90%; transform:translate(-50%,-90%) rotate(0deg); border-radius:2px; }
.heading-buttons{ display:flex; gap:8px; margin-top:8px; justify-content:center; }

/* è¨€èªï¼ˆç¸¦ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ï¼‰ */
.lang-acc{ margin-top:8px; }
.lang-acc > summary{ list-style:none; padding:10px 14px; border-radius:12px; background:rgba(255,255,255,.16); text-align:center; cursor:pointer; }
.lang-btn{ background:rgba(255,255,255,.16); border:none; border-radius:999px; color:#fff; padding:10px 14px; text-align:center; }

/* æ¤œç´¢çµæœï¼šæ¿å†…ã‹ã‚‰ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¤ãƒ³ãƒ»ã‚¢ã‚¦ãƒˆ */
.results{
  position:absolute; left:0; right:0; bottom:-420px;
  background:rgba(0,0,0,.45); border-radius:14px; max-height:340px; overflow:auto;
  transition:transform .25s ease, bottom .25s ease; transform:translateY(24px);
}
.results.show{ bottom:10px; transform:translateY(0); }
#results-list{ list-style:none; padding:8px 10px; margin:0; }
#results-list li{ background:rgba(255,255,255,.12); border-radius:12px; padding:10px; margin:8px 0; text-align:center; }

/* Leaflet ã‚ºãƒ¼ãƒ ã‚’å·¦ä¸‹ã¸ï¼ˆæ¿/ãƒœã‚¿ãƒ³éå¹²æ¸‰ï¼‰ */
.leaflet-control-container .leaflet-left .leaflet-control-zoom{
  margin-left: calc(env(safe-area-inset-left,0px) + 12px);
  margin-bottom: calc(env(safe-area-inset-bottom,0px) + 12px);
  margin-top:0; margin-right:0;
}

/* ç‹­å¹…èª¿æ•´ */
@media (max-width:420px){
  .btn-right{ min-width:96px; }
  .compass-dial{ width:76px; height:76px; }
}
</style>

<!-- Leafletï¼ˆCDNï¼‰ -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
<script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-o9N1j7kG9kG8a9kaK2vNhbbX6YsJh8e3toDnN2DXW8A=" crossorigin=""></script>

<!-- ã‚¢ãƒ—ãƒªæœ¬ä½“ -->
<script defer src="./app.js?v=5"></script>
</head>
<body>
  <div id="map"></div>

  <!-- å³ã‚µã‚¤ãƒ‰ï¼šç¾åœ¨åœ°/ç›®çš„åœ°/ãƒªãƒ«ãƒ¼ãƒˆ -->
  <div class="right-stack">
    <button id="btn-current" class="btn-right">ç¾åœ¨åœ°</button>
    <button id="btn-dest"    class="btn-right">ç›®çš„åœ°</button>
    <button id="btn-reroute" class="btn-right">ãƒªãƒ«ãƒ¼ãƒˆ</button>
  </div>

  <!-- æ–¹ä½è¨ˆï¼ˆå·¦ï¼‰ -->
  <div class="compass-wrap">
    <div class="compass-dial"><div id="compass-needle" class="compass-needle"></div></div>
    <div class="heading-buttons">
      <button id="btn-north"   class="btn">åŒ—ã‚’å‘ã</button>
      <button id="btn-heading" class="btn">é€²è¡Œæ–¹å‘</button>
    </div>
  </div>

  <!-- ã‚¬ãƒ©ã‚¹æ¿ -->
  <div id="panel" class="glass">
    <div class="row">
      <input id="q" class="input" placeholder="åç§°ãƒ»ä½æ‰€ãƒ»é›»è©±ç•ªå·ã§æ¤œç´¢" />
      <button id="btn-voice" class="btn green">ğŸ¤ éŸ³å£°</button>
    </div>

    <div class="row">
      <button id="btn-search" class="btn primary">æ¤œç´¢</button>
      <button id="btn-clear-history" class="btn">å±¥æ­´ã‚’ã‚¯ãƒªã‚¢</button>
      <button class="btn primary mode-btn" data-mode="shortest">æœ€çŸ­</button>
      <button class="btn mode-btn" data-mode="easy">æ¥½ãƒãƒ³</button>
      <button class="btn mode-btn" data-mode="walkai">ãŠæ•£æ­©Ai</button>
      <button class="btn mode-btn" data-mode="tour">è¦³å…‰æ¡ˆå†…</button>
    </div>

    <details class="lang-acc">
      <summary>è¨€èª / Language</summary>
      <div class="row" style="flex-direction:column">
        <button class="btn lang-btn primary" data-lang="ja">æ—¥æœ¬èª</button>
        <button class="btn lang-btn" data-lang="en">English</button>
        <button class="btn lang-btn" data-lang="de">Deutsch</button>
        <button class="btn lang-btn" data-lang="it">Italiano</button>
        <button class="btn lang-btn" data-lang="fr">FranÃ§ais</button>
        <button class="btn lang-btn" data-lang="es">EspaÃ±ol</button>
        <button class="btn lang-btn" data-lang="ko">í•œêµ­ì–´</button>
        <button class="btn lang-btn" data-lang="zh">ä¸­æ–‡</button>
      </div>
    </details>

    <div class="grid2">
      <div>
        <div class="center" style="margin:6px 0 4px">é–‹å§‹åœ°ç‚¹</div>
        <div class="grid2" style="gap:8px">
          <input id="start-lng" class="input" placeholder="çµŒåº¦" />
          <input id="start-lat" class="input" placeholder="ç·¯åº¦" />
        </div>
      </div>
      <div>
        <div class="center" style="margin:6px 0 4px">ç›®çš„åœ°ç‚¹</div>
        <div class="grid2" style="gap:8px">
          <input id="end-lng" class="input" placeholder="çµŒåº¦" />
          <input id="end-lat" class="input" placeholder="ç·¯åº¦" />
        </div>
      </div>
    </div>

    <div class="row">
      <button id="btn-save"      class="btn green">ç¾åœ¨åœ°ã‚’ä¿å­˜</button>
      <button id="btn-set-dest"  class="btn blue">ç›®çš„åœ°ã«è¨­å®š</button>
      <button id="btn-start"     class="btn green">æ¡ˆå†…é–‹å§‹</button>
      <button id="btn-stop"      class="btn red">æ¡ˆå†…ã‚’åœæ­¢</button>
    </div>

    <!-- æ¤œç´¢çµæœï¼ˆã‚¹ãƒ©ã‚¤ãƒ‰ï¼‰ -->
    <div id="results" class="results">
      <div style="display:flex;align-items:center;justify-content:center;padding:10px;position:sticky;top:0;background:rgba(0,0,0,.45)">
        <div style="flex:1;text-align:center;font-weight:700;">æ¤œç´¢çµæœ</div>
        <button id="btn-close-results" class="btn">Ã—</button>
      </div>
      <ul id="results-list"></ul>
    </div>

    <div id="status" class="center" style="margin-top:6px;opacity:.85"></div>
  </div>
</body>
</html>