<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ウォークナビ（ORD-003 ERR-001 対応版）</title>

<!-- Google Maps JS API：ブラウザ用キー（現行のまま） -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBzojEE2142O8dWPd7gmcAj-FyWumYyFy4" defer></script>

<style>
/* ===== 既存デザインは変更せず（色・サイズ・配置はそのまま） ===== */
:root{
  --glass: rgba(20,28,44,.54);
  --glass-strong: rgba(16,22,36,.68);
  --stroke: rgba(255,255,255,.14);
  --text: #eaf2ff;
  --muted:#a7b8ce;
  --primary:#5fb1ff;
  --ok:#25d07a;
  --danger:#ff6565;
  --accent:#64d2ff;
  --panelH: 240px;
}
html,body{height:100%;margin:0;background:#0e1a2d;color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP",Meiryo,sans-serif}
*{box-sizing:border-box}
a{color:inherit;text-decoration:none}
.app{position:relative;height:100dvh;overflow:hidden}
#map{position:absolute;inset:0}

/* HUD（文字案内・時刻・天気）—— 見た目は従来のまま */
.hud-wrap{position:absolute;left:12px;right:12px;top:10px;z-index:410;display:flex;flex-direction:column;gap:10px;pointer-events:none}
.hud{pointer-events:auto;background:var(--glass);border:1px solid var(--stroke);
  border-radius:14px;backdrop-filter: blur(14px) saturate(120%);-webkit-backdrop-filter: blur(14px) saturate(120%);
  box-shadow:0 10px 30px rgba(0,0,0,.35);padding:10px 14px}
#guideText{font-weight:800}
.timebar{display:flex;gap:10px}
.timepill{flex:1;background:rgba(255,255,255,.10);border:1px solid var(--stroke);border-radius:12px;padding:8px 10px;display:flex;align-items:center;justify-content:space-between}
.timepill small{opacity:.85}
#weatherBar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.wx{display:flex;align-items:center;gap:6px;background:rgba(255,255,255,.10);border:1px solid var(--stroke);border-radius:10px;padding:6px 8px}
.wx i{font-style:normal;font-weight:800}
.wx .t{opacity:.9}

/* 操作パネル（下付き／下方向へ収納。既存デザインを維持） */
.glassbar{position:absolute;left:0;right:0;bottom:0;z-index:420;padding:10px 12px;pointer-events:none}
.card{
  pointer-events:auto;background:var(--glass);border:1px solid var(--stroke);
  border-radius:16px;backdrop-filter: blur(14px) saturate(120%);-webkit-backdrop-filter: blur(14px) saturate(120%);
  box-shadow:0 10px 30px rgba(0,0,0,.35);padding:12px 12px;width:min(1100px, 96vw);margin:0 auto;
}
.row{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap}
.grow{flex:1 1 220px}
input,button,select{
  background:var(--glass-strong);border:1px solid var(--stroke);color:var(--text);
  border-radius:12px;padding:11px 13px;font-size:16px;outline:none;min-height:44px;max-width:100%;
}
button.primary{background:rgba(95,177,255,.92);border:none;font-weight:700}
button.ok{background:var(--ok);border:none;font-weight:700}
button.danger{background:var(--danger);border:none;font-weight:700}
button.ghost{background:rgba(255,255,255,.06)}
.hint{color:var(--muted);font-size:13px}

/* パネルの出し入れ（下付き） */
#panelWrap{transform:translateY(0);transition:transform .32s ease;will-change:transform}
.app.panel-open #panelWrap{transform:translateY(0)} /* 表示 */
.app.panel-closed #panelWrap{transform:translateY(calc(100% - 46px))} /* 収納してタブだけ残す */
#panelTab{position:absolute;left:50%;transform:translate(-50%,-8px);bottom:0;z-index:421;
  background:rgba(0,0,0,.55);border:1px solid var(--stroke);color:#fff;border-radius:22px;padding:8px 14px;}

/* ▼▼▼ ここが今回の“唯一の仕様変更ロジック” ▼▼▼
   パネル表示中は HUD（文字案内・時刻・天気）を非表示にする（ORD-003/ERR-001） */
.app.panel-open .hud{display:none !important;}
/* ▲▲▲ */

/* コンパス（左上固定。見た目は既存のまま） */
.comp-wrap{position:absolute;left:10px;top:78px;z-index:405}
.compass{width:90px;height:90px;background:var(--glass);border:1px solid var(--stroke);border-radius:50%;
  backdrop-filter: blur(10px) saturate(120%);-webkit-backdrop-filter: blur(10px) saturate(120%);
  box-shadow:0 10px 26px rgba(0,0,0,.35);display:flex;align-items:center;justify-content:center}
.compass svg{width:76px;height:76px}
.compass .needle{transform-origin:38px 38px;transform:rotate(0deg)}
.compass text{font-size:10px;fill:#f6d58b}

/* 右側・案内ボタン列（位置・デザイン変更なし） */
.fab-col{position:absolute;right:12px;top:50%;transform:translateY(-50%);z-index:430;display:flex;flex-direction:column;gap:10px}
.fab-col button{min-width:150px;box-shadow:0 12px 26px rgba(0,0,0,.45)}
@media (max-width:640px){ .fab-col button{min-width:130px} }
</style>
</head>
<body>
<div class="app panel-open" id="app">
  <div id="map"></div>

  <!-- ===== HUD（文字案内／時刻／天気） ===== -->
  <div class="hud-wrap" id="hudWrap">
    <div class="hud" id="guideBanner"><div id="guideText">目的地を設定してください。</div></div>
    <div class="hud timebar" id="timeBar">
      <div class="timepill"><small>現在時刻</small><span id="nowTime">--:--:--</span></div>
      <div class="timepill"><small>到着予想</small><span id="etaTime">--:--:--</span></div>
    </div>
    <div class="hud" id="weatherBar">
      <!-- 例: 3H/6H/12H を表示（中身は既存と同じ、今回は非表示切替のみ） -->
      <div class="wx"><i>3h</i><span class="t">--℃ / --%</span></div>
      <div>→</div>
      <div class="wx"><i>6h</i><span class="t">--℃ / --%</span></div>
      <div>→</div>
      <div class="wx"><i>12h</i><span class="t">--℃ / --%</span></div>
    </div>
  </div>

  <!-- コンパス（左上固定） -->
  <div class="comp-wrap" id="compWrap">
    <div class="compass" id="compass">
      <svg viewBox="0 0 76 76">
        <defs><radialGradient id="g" cx="50%" cy="50%" r="60%"><stop offset="0%" stop-color="#0b1626"/><stop offset="60%" stop-color="#0a1422"/><stop offset="100%" stop-color="#09121f"/></radialGradient></defs>
        <circle cx="38" cy="38" r="34" fill="url(#g)" stroke="rgba(255,255,255,.10)"/>
        <text x="38" y="12" text-anchor="middle">N</text>
        <g class="needle" id="needle"><polygon points="38,14 34,38 42,38" fill="#ff5252"/></g>
      </svg>
    </div>
  </div>

  <!-- 右側のボタン列（既存どおり） -->
  <div class="fab-col" id="fabCol">
    <button id="navStart" class="ok">案内開始</button>
    <button id="navStop"  class="danger">案内を停止</button>
    <button id="gotoStart" class="primary">現在地</button>
    <button id="gotoDest"  class="primary">目的地</button>
    <button id="reroute"   class="primary">リルート</button>
  </div>

  <!-- 操作パネル（下付き／下方向へ収納） -->
  <div class="glassbar" id="panelWrap">
    <div class="card" id="panel">
      <div class="row">
        <input id="q" class="grow" placeholder="店舗名・住所・電話番号で検索" autocomplete="off">
        <button id="mic" class="ghost" style="background:#0cb35a">🎤 音声</button>
        <button id="search" class="primary">検索</button>
        <button id="clearHistory" class="ghost">履歴をクリア</button>
      </div>

      <div class="row" style="margin-top:8px">
        <button class="ghost" id="modeShortest">最短Ai</button>
        <button class="ghost" id="modeEasy">楽チンAi</button>
        <button class="ghost" id="modeStroll">お散歩Ai</button>
        <button class="ghost" id="langToggle">▶ 言語 / Language</button>
      </div>

      <div class="row" style="margin-top:10px">
        <div class="grow">
          <div style="opacity:.75">現在地経度</div>
          <input id="startLon" placeholder="現在地経度">
        </div>
        <div class="grow">
          <div style="opacity:.75">現在地緯度</div>
          <input id="startLat" placeholder="現在地緯度">
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <div class="grow">
          <div style="opacity:.75">目的地経度</div>
          <input id="destLon" placeholder="目的地経度">
        </div>
        <div class="grow">
          <div style="opacity:.75">目的地緯度</div>
          <input id="destLat" placeholder="目的地緯度">
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <select id="savedList" class="grow"></select>
        <button id="openSaveModal" class="ok">現在地を保存</button>
        <button id="setFromSaved" class="primary">目的地に設定</button>
        <button id="delSaved" class="danger">削除</button>
      </div>

      <div class="row" style="margin-top:10px">
        <button id="panelClose" class="primary">操作パネルを閉じる</button>
      </div>

      <div class="row" style="margin-top:6px"><div id="msg" class="hint">準備完了。目的地を設定してください。</div></div>
    </div>

    <!-- 収納タブ（画面底中央） -->
    <button id="panelTab">▲ パネルを表示</button>
  </div>
</div>

<script>
/* ===== 最小限の初期化（既存機能は変えず） ===== */
const $=id=>document.getElementById(id);
const app=$('app'), panelWrap=$('panelWrap'), panel=$('panel'), tab=$('panelTab');
const guideBanner=$('guideBanner'), timeBar=$('timeBar'), weatherBar=$('weatherBar');

function setPanel(open){
  app.classList.toggle('panel-open', !!open);
  app.classList.toggle('panel-closed', !open);
  /* ★ ORD-003/ERR-001：パネル表示中は HUD を非表示（CSSで制御） */
}
function openPanel(){ setPanel(true); }
function closePanel(){ setPanel(false); }

/* 初期状態：表示（既存と同等） */
setPanel(true);

/* タブとボタンでトグル（仕様維持） */
tab.addEventListener('click', ()=> openPanel());
$('panelClose').addEventListener('click', ()=> closePanel());

/* 実時間の更新（見た目維持／挙動変更なし） */
function tick(){
  const now=new Date();
  $('nowTime').textContent=now.toLocaleTimeString();
}
setInterval(tick,1000); tick();

/* 地図（最小起動。詳細機能は既存のままという前提） */
let map;
window.addEventListener('load',()=>{
  if(typeof google==='object' && google.maps){
    map=new google.maps.Map(document.getElementById('map'),{
      center:{lat:34.342, lng:134.046}, zoom:16, mapTypeControl:false, streetViewControl:false
    });
  }
});
</script>
</body>
</html>